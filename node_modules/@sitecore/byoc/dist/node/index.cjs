"use strict";var E=Object.defineProperty;var te=Object.getOwnPropertyDescriptor;var ie=Object.getOwnPropertyNames;var re=Object.prototype.hasOwnProperty;var ne=(e,t)=>{for(var i in t)E(e,i,{get:t[i],enumerable:!0})},oe=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of ie(t))!re.call(e,n)&&n!==i&&E(e,n,{get:()=>t[n],enumerable:!(r=te(t,n))||r.enumerable});return e};var se=e=>oe(E({},"__esModule",{value:!0}),e);var ge={};ne(ge,{BYOCDataTypes:()=>h,BYOCRegistration:()=>w,WebComponent:()=>X,XMTypes:()=>P,contextProperties:()=>T,customizeDataSettings:()=>pe,getComponent:()=>_,getComponentConfigurablePropertyNames:()=>de,getComponentProperties:()=>Z,getDatasource:()=>U,getMergedComponentProperties:()=>ue,getSchemaDefaults:()=>R,getSchemaProperties:()=>N,isWebComponent:()=>V,normalizeOptions:()=>F,objectKeysToCamelCase:()=>ae,objectKeysToKebabCase:()=>D,parseSchemaProperties:()=>B,parseValue:()=>S,registerComponent:()=>Q,registerDataType:()=>q,registerDatasource:()=>H,registered:()=>x,registeredDatasources:()=>j,serializedContextProperties:()=>$,setContextProperties:()=>fe,setRegistrationCallback:()=>k,toCamelCase:()=>O,toKebabCase:()=>b,transformSchema:()=>v,transformSchemaObject:()=>M,transformUiSchema:()=>y,traverseSchema:()=>C});module.exports=se(ge);var D=(e={})=>Object.keys(e).reduce((t,i)=>Object.assign(t,{[b(i)]:e[i]}),{}),ae=(e={})=>Object.keys(e).reduce((t,i)=>Object.assign(t,{[O(i)]:e[i]}),{});function b(e){let t=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g;return O(e).replace(t,function(i){return"-"+i.toLowerCase()})}function O(e){return e=e.replace(/[-_ ]+/g," "),e=e.charAt(0).toLowerCase()+e.slice(1),e.split(/\s+/).map((t,i)=>i===0?t:t.charAt(0).toUpperCase()+t.slice(1)).join("")}var A=function(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(i[r[n]]=e[r[n]]);return i};function q(e,{name:t}){if(t.charAt(0)!=t.charAt(0).toUpperCase())throw new Error("Custom types must start with a capital letter");h[t]=e}var h={},ce=()=>({type:"object",properties:{href:{required:!0,type:"string",title:"URL",description:"The URL of the link, except for media items, for which the Url property contains the path to the media item relative to /Sitecore/Media Library."},text:{type:"string",title:"Text",description:"The text content of the HTML <a> element."},linktype:{type:"string",enum:["internal","external","media","anchor","mailto","javascript"],default:"internal",title:"Target",description:"The target attribute of the HTML <a> element."},title:{type:"string",title:"Title",description:"The title attribute of the HTML <a> element."},class:{type:"string",title:"Class Name",description:"The class attribute of the HTML <a> element."},target:{type:"string",title:"Target",description:"The target attribute of the HTML <a> element.",enum:["","_blank","_self","_parent","_top"]},anchor:{type:"string",title:"Anchor",description:"The name attribute of the HTML <a> element, without the leading hash character (\u201C#\u201D)."},querystring:{type:"string",title:"Query String",description:"Query string parameters to add to the URL."}}}),L=e=>{var{properties:t}=e,i=A(e,["properties"]);return Object.assign(Object.assign({},i),{type:"object",properties:{name:{type:"string"},displayName:{type:"string"},id:{type:"string"},url:{type:"string"},fields:J(t)}})};function J(e={}){return{type:"object",properties:Object.keys(e).reduce((t,i)=>{let r=e[i],{title:n}=r,c=A(r,["title"]);return Object.assign(Object.assign({},t),{[i]:{type:"object",properties:{value:Object.assign({title:n||i},e[i])}}})},{})}}var P={Link:ce,DropLink:L,DropTree:L,File:()=>({type:"object",properties:{src:{type:"string",title:"Source",description:"The URL of the file."},title:{type:"string",title:"Title",description:"Title of a file"},displayName:{type:"string",title:"Display name",description:"Display name of a file"}}}),Date:()=>({type:"string",format:"date"}),Datetime:()=>({type:"string",format:"date-time"}),RichText:()=>({type:"string"}),Image:e=>({type:"object",properties:Object.assign({src:{type:"string"}},e.properties)}),SingleLineText:()=>{},MultiLineText:()=>({type:"string"}),Checkbox:()=>({type:"boolean"}),String:()=>({type:"string"}),Number:()=>({type:"number"}),Boolean:()=>({type:"boolean"}),Item:L,List:e=>{var{properties:t}=e,i=A(e,["properties"]);return Object.assign(Object.assign({},i),{type:"array",items:{type:"object",properties:{name:{type:"string"},displayName:{type:"string"},id:{type:"string"},url:{type:"string"},fields:J(t)}}})}};Object.keys(P).forEach(e=>{q(P[e],{name:e})});function C(e,t){var i={};for(var r in e){let n=e[r];n&&typeof n=="object"?Array.isArray(n)?i[r]=n.map(c=>typeof c=="object"&&c?C(c,t):c):i[r]=C(t(n),t):i[r]=e[r]}return i}function v(e,t={}){return e=M(Object.assign({type:"object",properties:{},required:[]},e)),C(e,i=>i.properties?M(i,t):i)}function M(e,t={}){var i;let r=Object.assign({},e);return r.properties&&(r.required=((i=e.required)===null||i===void 0?void 0:i.slice())||[],r.properties=Object.keys(r.properties).reduce((n,c)=>{var a;let o=r.properties[c],s=(a=h[o==null?void 0:o.type])===null||a===void 0?void 0:a.call(h,o),l=Object.assign(Object.assign(Object.assign({},s),o),{type:(s==null?void 0:s.type)||o.type,default:t.hasOwnProperty(c)?t[c]:o.default,title:o.title||b(c).split("-").map(d=>d.charAt(0).toUpperCase()+d.slice(1).toLowerCase()).join(" ")});return(o!=null&&o.properties||s!=null&&s.properties)&&(l.properties=Object.assign({},(s==null?void 0:s.properties)||(o==null?void 0:o.properties)),Object.keys((s==null?void 0:s.properties)||{}).forEach(d=>{var f,u;l.properties[d]=Object.assign(Object.assign({},(f=s==null?void 0:s.properties)===null||f===void 0?void 0:f[d]),(u=o==null?void 0:o.properties)===null||u===void 0?void 0:u[d])})),(o!=null&&o.items||s!=null&&s.items)&&(l.items=(s==null?void 0:s.items)||(o==null?void 0:o.items)),l.default===void 0&&delete l.default,"required"in l&&typeof l.required=="boolean"&&(r.required.indexOf(c)==-1&&r.required.push(c),delete l.required),Object.assign(n,{[c]:l})},{})),Object.assign({type:"object"},r)}var y=(e,t)=>{var i,r,n,c;let a=Object.assign({},e);for(var o in t)typeof t[o]!="object"||!t[o]||((((i=t[o])===null||i===void 0?void 0:i.type)=="integer"||((r=t[o])===null||r===void 0?void 0:r.type)=="number")&&(a[o]=Object.assign(Object.assign({},a[o]),{"ui:options":{widget:"updown"}})),!((n=t[o])===null||n===void 0)&&n.ui&&(a[o]=Object.assign(Object.assign({},a[o]),{"ui:options":Object.assign(Object.assign({},(c=a[o])===null||c===void 0?void 0:c["ui:options"]),t[o].ui)})),a=Object.assign(Object.assign({},a),{[o]:t[o].items?{items:y(a[o],t[o].items.properties)}:y(a[o],t[o].properties||{})}));return a};function S(e,t){switch(t){case"string":return e;case"object":try{return typeof e=="object"&&e!=null?e:JSON.parse(e)}catch(i){return null}case"array":try{return Array.isArray(e)?e:JSON.parse(e)}catch(i){return null}case"number":return parseFloat(e);case"integer":return parseInt(e);case"boolean":return e=="true"||e=="1";default:return e}}function B(e,t){return Object.keys(t).reduce((i,r)=>{let n=t[r],c=O(r),a=e==null?void 0:e.properties[c],o=a==null?void 0:a.type,s=S(n,o);return s!=null&&!r.startsWith("data-attribute")&&!["class","id","contenteditable"].includes(r)?Object.assign(Object.assign({},i),{[c]:s}):i},{})}function N(e,t){return Object.assign(Object.assign({},R(e)),B(e,t))}function R(e){return Object.keys(e.properties).reduce((t,i)=>{var r,n;return((r=e.properties[i])===null||r===void 0?void 0:r.default)!=null?Object.assign(Object.assign({},t),{[i]:(n=e.properties[i])===null||n===void 0?void 0:n.default}):t},{})}var j=typeof window!="undefined"?window.BYOCDatasources||(window.BYOCDatasources={}):{};function H(e,t){if(typeof e!="function")throw new Error("The first argument of registerDatasource must be a function returning DataSettings or Promise of data");if(!t.id)throw new Error("Missing 'id' property in input");if(!/^[a-zA-Z0-9-_]+$/.test(t.id))throw new Error("Invalid 'id' property in input. 'id' should only contain alphanumeric characters, hyphens, and underscores.");j[t.id]=Object.assign(Object.assign({},le(t)),{handler:e}),K()}function U(e){return j[e]}function le(e){let{id:t,name:i,title:r,properties:n,sample:c,schema:a,description:o=null,type:s="object"}=e;return{id:t,description:o,sample:c,name:i||r||t,handler:l=>l,schema:a||n?v(Object.assign(Object.assign({},a||{properties:n,type:s}),{title:(a==null?void 0:a.title)||r||i})):void 0}}var W;function K(){clearTimeout(W),typeof window!="undefined"&&window.parent!==window&&(W=setTimeout(()=>{var e;(e=window.parent)===null||e===void 0||e.postMessage(JSON.stringify({action:"register-datasources",data:Object.values(j)}),"*")},30))}K();function pe(e,t){let i=j[e];return i!=null&&i.handler?i.handler(t):t}var Y=function(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(i[r[n]]=e[r[n]]);return i};function F(e,t,i){let{thumbnail:r="https://feaasstatic.blob.core.windows.net/assets/thumbnails/byoc.svg",name:n,id:c=e.name,group:a=null,ui:o,isHidden:s=!1,datasourceIds:l=[],links:d={},meta:f={},uiSchema:u,schema:p}=e,g=Y(e,["thumbnail","name","id","group","ui","isHidden","datasourceIds","links","meta","uiSchema","schema"]),I=p||g||{},G=u||o||{},m=v(Object.assign(Object.assign({description:"External component"},I),{type:"object"}),i),ee=y(G,m.properties||{});return{component:t||(()=>null),name:n,schema:m,uiSchema:ee,thumbnail:r,group:a||"Default collection",isHidden:s,id:c,datasourceIds:l,links:d,meta:f,title:(m==null?void 0:m.title)||(g==null?void 0:g.title)||n}}var z,X=typeof HTMLElement!="undefined"?HTMLElement:typeof windowJSDOM!="undefined"?windowJSDOM.HTMLElement:class{setAttribute(){}},x=typeof window!="undefined"?window.BYOCComponents||(window.BYOCComponents={}):{};function Q(e,t,i={}){if(!(t!=null&&t.name))throw new Error("Could not register external component. Please make sure you provide a name in the options"+JSON.stringify(t));let r=F(t,e,i);x[r.id]=r,V(e)&&w.register("byoc-"+b(t.name),void 0,e),k()}function V(e){return e&&"prototype"in e&&"setAttribute"in e.prototype}function Z(e,t={}){var i;let r=(i=_(e))===null||i===void 0?void 0:i.schema;return r?N(r,t):t}function de(e){let t=_(e);return Object.keys((t==null?void 0:t.schema.properties)||{}).filter(i=>{var r,n;return((n=(r=t==null?void 0:t.uiSchema)===null||r===void 0?void 0:r[i])===null||n===void 0?void 0:n["ui:widget"])!="hidden"})}function _(e){if(typeof e!="string"){if(e&&"schema"in e)return e;throw new Error(`Component name should be a string, got ${typeof e}`)}let[t,i]=e.split("?");var r=x[t];if(i){let n=x[e];if(!n&&!r)return null;n&&(r=Object.assign(Object.assign(Object.assign({},r),n),{component:n.component||(r==null?void 0:r.component)})),i.split(/\&/g).forEach(c=>{var a,o,s;let[l,d]=c.split("="),f=((a=r.schema.properties)===null||a===void 0?void 0:a[l])||{type:"string"};r=Object.assign(Object.assign({},r),{schema:Object.assign(Object.assign({},r.schema),{properties:Object.assign(Object.assign({},r.schema.properties),{[l]:Object.assign(Object.assign({},f),{default:S(decodeURIComponent(d),f.type)})})}),uiSchema:Object.assign(Object.assign({},r.uiSchema),{[l]:Object.assign(Object.assign({},r.uiSchema[l]),{"ui:widget":(s=(o=r.uiSchema[l])===null||o===void 0?void 0:o["ui:widget"])!==null&&s!==void 0?s:"hidden"})})})})}return r}function ue(e){let{componentName:t,className:i,fallbackWrapper:r,fallback:n,suppressHydrationWarning:c,_dynamic:a,datasources:o}=e,s=Y(e,["componentName","className","fallbackWrapper","fallback","suppressHydrationWarning","_dynamic","datasources"]);try{var l=typeof o=="string"?JSON.parse(o):o}catch(p){}let d=Object.values(l||{}).find(p=>p&&!Array.isArray(p)&&Object.keys(p).length>0),f=Object.assign(Object.assign(Object.assign({},d),Z(t,Object.assign(Object.assign({},d),s))),l?{datasources:l}:{}),u=Object.assign(Object.assign({"data-external-id":t},D(f)),{suppressHydrationWarning:!0,class:i});return $.forEach(p=>{Object.assign(u,{[b(p)]:T[p]})}),Object.keys(u).forEach(p=>{let g=u[p];if(g&&typeof g=="object"&&p!="class"&&p!="children")try{Object.assign(u,{[p]:JSON.stringify(g)})}catch(I){delete u[p]}(typeof g=="function"||g==null)&&delete u[p]}),{attributes:u,properties:f,merged:Object.assign(Object.assign({},T),f)}}function k(){clearTimeout(z),typeof window!="undefined"&&window.parent!==window&&(z=setTimeout(()=>{var e;(e=window.parent)===null||e===void 0||e.postMessage(JSON.stringify({action:"register-components",data:Object.values(x)}),"*")},30))}k();var w=class extends X{connectedCallback(){try{JSON.parse(String(this.getAttribute("components"))).forEach(t=>{_(t.id)||Q(null,t)}),JSON.parse(String(this.getAttribute("datasources"))).forEach(t=>{U(t.id)||H(i=>i,t)})}catch(t){}}static register(t,i,r=this){i==null&&(i=typeof window!="undefined"?window:void 0),i&&!i.customElements.get(t)&&i.customElements.define(t,class extends r{})}},T={};function fe(e){T=e}var $=["sitecoreEdgeUrl","sitecoreEdgeContextId"];w.register("byoc-registration");0&&(module.exports={BYOCDataTypes,BYOCRegistration,WebComponent,XMTypes,contextProperties,customizeDataSettings,getComponent,getComponentConfigurablePropertyNames,getComponentProperties,getDatasource,getMergedComponentProperties,getSchemaDefaults,getSchemaProperties,isWebComponent,normalizeOptions,objectKeysToCamelCase,objectKeysToKebabCase,parseSchemaProperties,parseValue,registerComponent,registerDataType,registerDatasource,registered,registeredDatasources,serializedContextProperties,setContextProperties,setRegistrationCallback,toCamelCase,toKebabCase,transformSchema,transformSchemaObject,transformUiSchema,traverseSchema});
//# sourceMappingURL=index.cjs.map
